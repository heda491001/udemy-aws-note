==== Service Control Policies (SCP) =======

Define allowlist or blocklist IAM actions

Applied at the <OU> or <Account> level

Does not apply to the <Management Account> and the <Root OU>
    even you attached one SCP, it won't work


SCP is applied to all the <Users> and <Roles> in the account, 
    including <Root user>

The SCP does not affect Service-linked roles
    Service-linked roles enable other AWS services 
    to integrate with AWS Organizations and can't be restricted by SCPs.

SCP must have an explicit Allow 
    (does not allow anything by default)

Use cases:
    Restrict access to certain services 
        (for example: can’t use EMR)
    Enforce PCI compliance by explicitly disabling services

Sample Policies
https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_examples.html


==== IAM Policy Evaluation Logic ======

For detail
https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_evaluation-logic.html



==== Restricting Tags with IAM Policies =====

You can restrict specific Tags on AWS resources

Using the aws:TagKeys Condition Key

Validate the Tag Keys attached to a resource 
against the Tag Keys in the IAM Policy

Example: 
    allow IAM users to create EBS Volumes 
    only if it has the “Env” and “CostCenter” Tags

Use either 
    ForAllValues (must have all keys) 
        or
    ForAnyValue (must have any of these keys at a minimum)

Using SCP to Restrict Creating Resources without appropriate Tags
    - Prevent IAM Users/Roles in the affected Member accounts 
      from creating resources if they don’t have a specific Tags
    
    Example: 
        restrict launching an EC2 instance 
        if it doesn’t have the “Project” and “CostCenter” Tags

---------------------Example---------------------------------
        {
            "Version":"2012-10-17",
            "Statement":[
                {
                    "Sid": "DenyRunInstancewithNoProjectTag",
                    "Effect": "Deny",
                    "Action": ""ec2:RunInstances",
                    "Resource": [
                        "arn:aws:ec2:*:*:instance/*",
                        "arn:aws:ec2:*:*:volume/*"
                    ],
                    "Condition":{
                        "Null": {
                            "aws:RequestTag/Project":"true'
                        }
                },
                {
                    "Sid": "DenyRunInstanceWithNoCostCenterTag",
                    "Effect": "Deny",
                    "Action": "ec2:RunInstances",
                    "Resource":[
                        "arn:aws:ec2:*:*:instance/*",
                        "arn:aws:ec2:*:*:volume/*"
                    ],
                    "Condition":{
                        "Null": {
                            "aws:RequestTag/CostCenter":"true"
                        }
                    }
                }
            ]
        }

--------------------------------------------------------------



=========== Tag Policies ===========

Helps you standardize tags across resources in an AWS Organization
    * tag policy define in organization level

Ensure 
    consistent tags, 
    audit tagged resources, 
    maintain proper resources categorization, 
    ...

You define Tag keys and their allowed values

Helps with 
    AWS Cost Allocation Tags 
        and 
    Attribute-based Access Control

Prevent 
    any non-compliant tagging operations 
    on specified services and resources

Generate a report 
    that lists all tagged/non-compliant resources

Use CloudWatch Events to monitor non-compliant tags

example:
    below policy, tag <CostCenter> can only have value "100" or "200"
---------------
{
    "tags": {
        "costcenter":{
            "tag_key": {
                "@@assign":"CostCenter"
            },
            "tag_value": {
                "@@assign": ["100","200"]
            },
            "enforced_for": {
                "@@assign": ["secretsmanager:*"]
            }
        }
    }
}
---------------




======  AI Services Opt-out Policies =============

Certain <AWS AI services> may use your content 
    for continuous improvement of Amazon AI/ML services

Example: 
    Amazon Lex, Amazon Comprehend, Amazon Polly, ...

You can opt-out of having your content stored or used by <AWS AI services>

Create an Opt-out Policy 
    that enforces this setting across all Member accounts and AWS Regions

You can opt-out all AI services or selected services

Can be attached to 
    Organization Root, 
    specific OU, 
    or individual Member account

for example: 


---# to access All services #-------
{
    "services":{
        "default": {
            "opt_out_policy": {
                "@@assign": "optOut"
            }
        }
    }
}

---# only allow Rekognition & Lex #-------
{
    "services":{
        "rekognition":{
            "opt_out_policy":{
                "@@assign": "optOut"
            }
        },
        "lex":{
            "opt_out_policy":{
                "@@assign": "optOut"
            }
        },
    }
}    




======  Backup Policies =============

<AWS Backup> enables you 
    to create Backup Plans 
    that define how to backup your AWS resources

JSON documents that define Backup Plans across an AWS Organization

Gives you granular control over backing up your resources 
    (e.g., backup frequency, time window, backup region, ...)

Can be attached to 
    Organization Root, 
    specific OU, 
    or individual Member account

Immutable Backup Plans appear in Member accounts 
    it will appear in the <AWS Backup> service console 
        (view ONLY)
    but only Management Account can change it 